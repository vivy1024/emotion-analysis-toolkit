# enhance_hidden.core 模块

## 模块概述

`core` 模块是 `enhance_hidden` 应用程序的核心，定义了基础数据结构、事件处理机制、处理流程管道以及通用的基类。

## 主要组件

*   `data_types.py`: 定义了贯穿整个应用程序使用的核心数据结构，例如 `FrameData`（包含图像和处理结果）、各种情绪表示（`EmotionData`, `MicroExpression`, `MacroExpression`, `HiddenEmotion`）、`FaceData`、`PoseData`、`ActionUnit` 等。
*   `event_bus.py`: 实现了一个简单的发布/订阅事件总线，用于解耦不同组件（如处理引擎和 UI 面板）之间的通信。
*   `pipeline.py`: 定义并管理数据处理流水线。它按顺序协调各个处理引擎（如人脸检测、情绪分析）对输入帧的执行。
*   `frame.py`: 定义了核心的 `Frame` 类，用于封装视频帧的图像数据、元数据以及诸如人脸检测和情绪分析之类的处理结果。
*   `emotion.py`: 定义了与情绪相关的数据模型（如 `EmotionState`, `EmotionTracker`, `HiddenEmotionState`, `EmotionProfile`）和状态表示，以及处理情绪数据转换和计算的逻辑。
*   `base.py`: 提供了一些基础类或抽象接口，供其他核心组件或引擎继承，以促进代码复用和标准化。
*   `__init__.py`: 初始化模块，可能导出关键类和函数。

## 功能

*   定义标准化的数据结构，确保数据在不同模块间一致地传递。
*   提供事件驱动的通信机制，降低模块间的耦合度。
*   编排和管理复杂的数据处理流程。
*   提供可复用的基础组件和工具。

## 设计原则

*   **数据驱动**: 以统一的数据结构（如 `FrameData`）为中心进行处理。
*   **模块化与解耦**: 通过事件总线和清晰定义的接口减少依赖。
*   **流程化**: 使用处理管道明确数据处理步骤。
*   **可扩展性**: 方便添加新的数据类型、事件或处理阶段。

## 关键概念

*   **FrameData**: 流水线中传递的主要数据单元，包含原始图像及各阶段的处理结果。
*   **Event Bus**: 组件间通信的桥梁，例如引擎处理完一帧后发布 `FRAME_PROCESSED` 事件，UI 订阅此事件更新显示。
*   **Pipeline**: 定义了数据处理的顺序和逻辑，例如先进行人脸检测，再进行情绪分析。 