# 宏表情训练工具集

## 概述

宏表情识别模型训练工具，支持 FER2013 等公开数据集，输出 PyTorch 模型供实时检测系统使用。

## 命令

```bash
python -m macro_expression.multi_dataset_train --dataset fer2013
```

## 架构

```
macro_expression/
├── multi_dataset_train.py      # 训练入口，支持多数据集切换
├── emotion_model.py            # 模型工厂 get_emotion_model()
└── requirements.txt
```

### 模型工厂

`emotion_model.py` 提供 `get_emotion_model()` 函数，根据参数返回不同架构的模型：

```python
model = get_emotion_model(model_name="resnet18", num_classes=7, pretrained=True)
```

## 支持的数据集

| 数据集 | 类别数 | 样本量 | 说明 |
|--------|--------|--------|------|
| FER2013 | 7 | ~35K | 公开，48×48 灰度图 |
| AffectNet | 8 | ~400K | 需申请 |
| RAF-DB | 7 | ~30K | 需申请 |

## 情绪类别（7 类）

```
angry, disgust, fear, happy, sad, surprise, neutral
```

## 输出

训练产出的 `macro.pt` 模型文件需手动复制到 `hidden_emotion_detection/models/` 目录，并更新 `config.json` 中的路径。
